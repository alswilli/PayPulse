<!-- <mat-spinner *ngIf="isLoading" style="margin: auto"></mat-spinner> -->
<div *ngIf="initialLoad">
  <p>No accounts added! Please add an account to see budgets</p>
</div>
<div [hidden]="initialLoad">
  <!-- <div fxLayoutAlign="center bottom">
    <mat-form-field>
      <mat-label>From:</mat-label>
      <mat-select id="from" #from> 
        <mat-option *ngFor="let month of fromMonths" [value]="month">
          {{month}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field style="margin-left: 10px;">
      <mat-label>To:</mat-label>
      <mat-select id="to" #to> 
        <mat-option *ngFor="let month of toMonths" [value]="month">
          {{month}}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div> -->
  <div fxLayout.lt-md="column">
    <!-- <div fxFlex='1'></div> -->
    <div fxFlex='50' class="mainPanels">
      <h2>Trends</h2>
      <mat-form-field>
        <mat-label>From:</mat-label>
        <mat-select id="from" #from> 
          <mat-option *ngFor="let month of fromMonths" [value]="month">
            {{month}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field style="margin-left: 10px;">
        <mat-label>To:</mat-label>
        <mat-select id="to" #to> 
          <mat-option *ngFor="let month of toMonths" [value]="month">
            {{month}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-spinner *ngIf="isLoading" style="margin: auto"></mat-spinner>
      <div *ngIf="!isLoading">
        <h3 *ngIf="(totalBudgetedExpenses / (totalBudget * totalMonthsActive)) >= 1" style="color: red;">
          <span style="color: black;">Budgeted Expenses: </span>{{totalBudgetedExpenses}} / {{(totalBudget * totalMonthsActive)}}
        </h3>
        <h3 *ngIf="!((totalBudgetedExpenses / (totalBudget * totalMonthsActive)) >= 1) && (totalBudgetedExpenses / (totalBudget * totalMonthsActive)) >= 0.75" style="color: orange;">
          <span style="color: black;">Budgeted Expenses: </span>{{totalBudgetedExpenses}} / {{(totalBudget * totalMonthsActive)}}
        </h3>
        <h3 *ngIf="!((totalBudgetedExpenses / (totalBudget * totalMonthsActive)) >= 0.75) && (totalBudgetedExpenses / (totalBudget * totalMonthsActive)) >= 0" style="color: green;">
          <span style="color: black;">Budgeted Expenses: </span>{{totalBudgetedExpenses}} / {{(totalBudget * totalMonthsActive)}}
        </h3>
        <!-- <h3>Budgeted Expenses: {{totalBudgetedExpenses}} / {{totalBudget}}</h3> -->
        <div>
          <app-pie-chart *ngIf="totalBudgetedExpenses > 0" [data]="pieData"></app-pie-chart>
          <p *ngIf="totalBudgetedExpenses === 0">Graph is empty!</p>
        </div>
      </div>
    </div>
    <!-- <div fxFlex='1'></div> -->
    <div fxFlex='50' class="mainPanels">
      <h2>Budgets</h2>
      <div class="example-action-buttons">
        <div fxFlex='70'>
          <button mat-raised-button color="primary" id="addButton" (click)="onAddBudgetClicked();">Add New Budget</button>
        </div>
        <button mat-button (click)="accordion.openAll()">Expand All</button>
        <button mat-button (click)="accordion.closeAll()">Collapse All</button>
      </div>
      <mat-spinner *ngIf="isLoading" style="margin: auto"></mat-spinner>
      <div *ngIf="!isLoading"> 
        <div *ngIf="budgets.length === 0">
          <p>No budgets added! Please add a budget using the 'Add New Budget' button above</p>
        </div>
          <mat-accordion class="example-headers-align" multi>
            <div class="budgetList">
              <mat-expansion-panel *ngFor="let budget of budgets; let i = index;">
                <mat-expansion-panel-header id="{{'budgetHeader' + i}}">
                  <p fxFlex *ngIf="budget.mainCategory === budget.category3">
                    {{ budget.category }}: {{ budget.category2 }}: <b>{{ budget.category3 }}</b> 
                  </p>
                  <p fxFlex *ngIf="budget.mainCategory === budget.category2">
                    {{ budget.category }}: <b>{{ budget.category2 }}</b> 
                  </p>
                  <p fxFlex *ngIf="budget.mainCategory === budget.category">
                    <b>{{ budget.category }}</b> 
                  </p>
                  <p fxLayoutAlign="end center" style="margin-right: 10px;">
                    <span *ngIf="(budget.total / (budget.amount * totalMonthsActive)) >= 1" style="color: red;">
                      <b>{{ budget.total }} / {{ (budget.amount * totalMonthsActive) }}</b>
                    </span>
                    <span *ngIf="!((budget.total / (budget.amount * totalMonthsActive)) >= 1) && (budget.total / (budget.amount * totalMonthsActive)) >= 0.75" style="color: orange;">
                      <b>{{ budget.total }} / {{ (budget.amount * totalMonthsActive) }}</b>
                    </span>
                    <span *ngIf="!((budget.total / (budget.amount * totalMonthsActive)) >= 0.75) && (budget.total / (budget.amount * totalMonthsActive)) >= 0" style="color: green;">
                      <b>{{ budget.total }} / {{ (budget.amount * totalMonthsActive) }}</b>
                    </span>
                  </p>
                </mat-expansion-panel-header>
                <button mat-raised-button style="background-color: grey; color: white;" id="{{'editButton' + i}}" (click)="onEditBudgetClicked(budget);">Edit Budget</button>
                <button mat-raised-button color="warn" style="margin: 10px;" id="{{'deleteButton' + i}}" (click)="onDeleteBudgetClicked(budget);">Delete Budget</button>
            
              </mat-expansion-panel>
            </div>
          </mat-accordion>
      </div>
    </div>
    <!-- <div fxFlex='1'></div> -->
  </div>
</div>

